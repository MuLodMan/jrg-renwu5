<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>JS Bin</title>
  <style>
  	.content{
  		position: relative;
  	}
  	.item{
  		position: absolute;
  		width: 200px;
  		margin-right: 10px;
  		margin-top: 10px;
  		transition: all 1s;
  	}
  	.h1{
  		height: 200px;
  		background-color: red;
  	}
  	.h2{
  		height: 400px;
  		background-color: yellow;
  	}
  	.h3{
  		height: 500px;
  		background-color: orange;
  	}
  </style>
</head>
<body>
	<div class="content">
		<div class="item h1">1</div>
		<div class="item h2">2</div>
		<div class="item h3">3</div>
		<div class="item h1">4</div>
		<div class="item h2">5</div>
		<div class="item h3">6</div>
		<div class="item h1">7</div>
		<div class="item h2">8</div>
		<div class="item h3">9</div>
		<div class="item h1">10</div>
		<div class="item h2">11</div>
		<div class="item h3">12</div>
		<div class="item h1">13</div>
		<div class="item h2">14</div>
		<div class="item h3">15</div>
		<div class="item h1">16</div>
		<div class="item h2">17</div>
		<div class="item h3">18</div>
	</div>
  <script src="http://apps.bdimg.com/libs/jquery/1.9.1/jquery.js"></script>
  <script>
  	// function render(){
  	// 	var $item=$('.item'),
  	// 		itemW=$('.item').outerWidth(true),
  	// 		colNum=parseInt($(window).width()/itemW),
  	// 		colSumHeight=[];
  	// 	for(var i=0;i<colNum;i++){
  	// 		colSumHeight.push(0);
  	// 	}
  	// 	$item.each(function(){
  	// 		var $cur=$(this);
  	// 		//console.log($cur)
  	// 		var minHeight=colSumHeight[0],
  	// 			idx=0,
  	// 			curH=$cur.outerHeight(true);
  	// 			//console.log(curH)
  	// 		for(var i=0;i<colNum;i++){
  	// 			if(minHeight>colSumHeight[i]){
  	// 				console.log(colSumHeight[i])
  	// 				minHeight=colSumHeight[i];
  	// 				idx=i;
  	// 			}
  	// 		}
  	// 		console.log(minHeight)
  	// 		$cur.css({
  	// 			'left':idx*itemW,
  	// 			'top':minHeight 
  	// 		})
  	// 		colSumHeight[idx] += curH;
  	// 	})
  	// }
  	// render();
  	// $(window).on('resize',function(){
  	// 	render();
  	// })
  	var water=(function($){
  		function render(){
  			var $item=$('.item'),
  				itemW=$('.item').outerWidth(true),
  				colNum=parseInt($(window).width()/itemW),
  				colSumHeight=[];
  			for(var i=0;i<colNum;i++){
  				colSumHeight.push(0);
  			}
  			$item.each(function(){
  				var $cur=$(this);
  				//console.log($cur)
  				var minHeight=colSumHeight[0],
  					idx=0,
  					curH=$cur.outerHeight(true);
  					//console.log(curH)
  				for(var i=0;i<colNum;i++){
  					if(minHeight>colSumHeight[i]){
  						console.log(colSumHeight[i])
  						minHeight=colSumHeight[i];
  						idx=i;
  					}
  				}
  				console.log(minHeight)
  				$cur.css({
  					'left':idx*itemW,
  					'top':minHeight 
  				})
  				colSumHeight[idx] += curH;
  			})
  		}
  		render();
  		$(window).on('resize',function(){
  			render();
  		})
  		return {
  			init:render
  		}
  	})($)
  	water.init()
  </script>
</body>
</html>